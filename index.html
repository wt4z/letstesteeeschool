<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Bullis School – Potomac</title>
<style>
:root{
  --gold:#FFC726;
  --notif-bg:rgba(44,44,44,0.92);
}
body{font-family:Arial,sans-serif;margin:0;background:#f4f7fb;color:#08304a}
header{background:#002F6C;color:var(--gold);padding:20px;text-align:center}
nav{background:#e2e8f0;padding:10px;display:flex;justify-content:center;gap:20px}
nav a{text-decoration:none;color:#002F6C;font-weight:bold}
main{padding:20px;max-width:900px;margin:auto}
section{background:#fff;padding:15px;margin-bottom:15px;border-radius:8px;box-shadow:0 2px 5px rgba(0,0,0,.1)}
h2{color:#002F6C}
footer{background:#002F6C;color:var(--gold);text-align:center;padding:15px}
img.logo{height:50px;vertical-align:middle;margin-right:10px}
#passwordBox{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);background:#fff;border:2px solid #002F6C;border-radius:8px;padding:20px;width:320px;box-shadow:0 2px 6px rgba(0,0,0,.2);}
#passwordBox input{display:block;margin-bottom:10px;padding:8px;font-size:14px;border:1px solid #ccc;border-radius:4px;width:100%;box-sizing:border-box;}
#passwordBox button{padding:10px;font-size:14px;background:#002F6C;color:var(--gold);border:none;border-radius:4px;cursor:pointer;width:100%;}
#errorText{color:#c0392b;font-size:13px;margin-top:6px;display:none;text-align:center;}
#embedContainer{display:none;margin-top:20px;width:100%;height:500px}
#notifArea{position:fixed;left:18px;bottom:18px;z-index:1400;display:flex;flex-direction:column-reverse;gap:10px;max-width:360px}
.notif{background:var(--notif-bg);color:#fff;padding:12px 14px;border-radius:10px;box-shadow:0 8px 20px rgba(0,0,0,0.45);border:1px solid rgba(255,199,38,0.12);display:flex;gap:10px;align-items:flex-start;min-width:220px;position:relative;overflow:hidden}
.notif strong{color:var(--gold)}
.notif .closeBtn{position:absolute;right:8px;top:6px;background:transparent;border:none;color:#fff;font-weight:bold;cursor:pointer;font-size:14px}
#clearAllBtn{display:none;align-self:flex-start;padding:6px 10px;border-radius:8px;border:1px solid rgba(255,199,38,0.18);background:transparent;color:var(--gold);cursor:pointer;margin-bottom:6px}
.notif .meta{font-size:12px;color:#e8e8e8;margin-top:6px}
</style>
</head>
<body>

<header>
  <img src="https://resources.finalsite.net/images/f_auto,q_auto,t_image_size_1/v1721670094/bullis/vbqhybisnzf52q6lwhbd/SecondaryBulldogFullColor.png" alt="Bulldog Logo" class="logo">
  <span>Bullis School – Potomac, MD</span>
  <p>“Caring • Challenging • Community”</p>
</header>

<nav>
  <a href="#">Home</a>
  <a href="#">About</a>
  <a href="#">Students</a>
  <a href="#">Faculty & Staff</a>
  <a href="#">Contact</a>
</nav>

<main>
  <section id="announcementsSection">
    <h2>Announcements</h2>
    <ul id="announcementsList"><li>Loading announcements...</li></ul>
  </section>

  <section>
    <h2>Upcoming Events</h2>
    <ul>
      <li>Varsity Football: Saturday at 1 p.m. at Kline Stadium</li>
      <li>Upper School Science Expo: Next Tuesday, 5–7 p.m.</li>
      <li>Drama Production: “The Taming of the Shrew” – Thursday, 7 p.m.</li>
    </ul>
  </section>

  <section>
    <h2>Resources</h2>
    <p>Access your schedules, class links, and our Bulldog community portal. Stay connected, stay inspired.</p>
  </section>

  <div id="embedContainer">
    <iframe src="https://myappsclasslink.pegle.com" width="100%" height="100%" style="border:0"></iframe>
  </div>
</main>

<div id="passwordBox">
  <input id="loginUser" type="text" placeholder="Username">
  <input id="loginPass" type="password" placeholder="Password">
  <button id="loginBtn">Login</button>
  <div id="errorText"></div>
</div>

<div id="notifArea" aria-live="polite" aria-atomic="false">
  <button id="clearAllBtn">Clear All</button>
</div>

<footer>
  &copy; 2025 Bullis School • 10601 Falls Rd, Potomac, MD 20854
</footer>

<script>
// Hardcoded users (replace/add as needed)
const users = [
  { username: "student1", password: "pass123", role: "user" },
  { username: "student2", password: "abc123", role: "user" },
  { username: "admin", password: "admin123", role: "admin" }
];

const NOTIF_TIMEOUT_MS = 30000;

function createNotification(title,message,options={}) {
  const notif = document.createElement("div");
  notif.className="notif";
  notif.innerHTML=`<div><strong>${title}</strong><div class="meta">${message}</div></div>`;
  const closeBtn = document.createElement("button");
  closeBtn.className="closeBtn"; closeBtn.innerHTML="✕";
  closeBtn.addEventListener("click",()=>{ notif.remove(); updateClearBtn(); });
  notif.appendChild(closeBtn);
  document.getElementById("notifArea").appendChild(notif);
  updateClearBtn();
  if(!options.sticky) setTimeout(()=>{ notif.remove(); updateClearBtn(); }, options.timeoutMs||NOTIF_TIMEOUT_MS);
}

function updateClearBtn(){
  document.getElementById("clearAllBtn").style.display = document.querySelectorAll("#notifArea .notif").length>1?"inline-block":"none";
}

document.getElementById("clearAllBtn").addEventListener("click",()=>{
  document.querySelectorAll("#notifArea .notif").forEach(n=>n.remove());
  updateClearBtn();
});

document.getElementById("loginBtn").addEventListener("click",()=>{
  const username = document.getElementById("loginUser").value.trim();
  const password = document.getElementById("loginPass").value.trim();
  const user = users.find(u=>u.username===username && u.password===password);
  const errorText = document.getElementById("errorText");

  if(!user){
    errorText.style.display="block";
    errorText.textContent="Invalid username or password";
    return;
  }

  // Login success
  document.getElementById("passwordBox").style.display="none";
  document.getElementById("embedContainer").style.display="block";
  createNotification("Login Successful", `Welcome, ${user.username}`);
  if(user.role==="admin"){
    createNotification("Admin Access", "Admin panel would be shown here");
  }
});

// Load announcements
async function loadAnnouncements(limitLastN=null){
  const list = document.getElementById("announcementsList");
  try{
    const res = await fetch("https://docs.google.com/spreadsheets/d/e/2PACX-1vQ_-w-DAPezbAzU8xZOylF9OnrPxen42KrzJ6MayaRzHxCcj8i6TjVDGfkqidkb2ouMxnit-ocEay61/pub?output=csv");
    const text = await res.text();
    const lines = text.trim().split("\n");
    if(lines.length<=1){ list.innerHTML="<li>No announcements</li>"; return; }
    const rows = lines.slice(1);
    if(limitLastN) rows.splice(0, rows.length-limitLastN);
    list.innerHTML="";
    rows.forEach(r=>{
      const cols = r.split(",");
      const li = document.createElement("li");
      li.innerHTML=`<strong>${cols[0].trim()}</strong>: ${cols[1]?.trim()||""}`;
      list.appendChild(li);
    });
  }catch(e){ list.innerHTML="<li>Failed to load announcements</li>"; console.error(e); }
}

loadAnnouncements();
</script>

</body>
</html>
